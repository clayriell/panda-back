<style>
  @page {
    size: A4;
    margin: 15mm;
  }

  body {
    font-family: "Arial", sans-serif;
    margin: 0;
    padding: 0;
    font-size: 10pt;
  }

  .page {
    width: 210mm;
    min-height: 297mm;
    padding: 15mm;
    margin: 0 auto;
    background: white;
    box-shadow: 0 0 5px rgba(0,0,0,0.1);
    position: relative;
  }

  .header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 20px;
  }

  .logo {
    width: 60px;
    height: 60px;
    border: 2px solid #000;
  }

  .company-info {
    text-align: right;
    font-size: 9pt;
    line-height: 1.3;
  }

  .company-info strong {
    font-size: 10pt;
  }

  h1 {
    text-align: center;
    font-size: 14pt;
    font-weight: bold;
    margin: 20px 0 5px 0;
    text-decoration: underline;
  }

  h2 {
    text-align: center;
    font-size: 11pt;
    font-style: italic;
    margin: 0 0 15px 0;
    font-weight: normal;
  }

  .declaration {
    font-size: 9pt;
    margin-bottom: 15px;
    line-height: 1.4;
  }

  .content-box {
    border: 2px solid #000;
    padding: 15px;
    margin-bottom: 15px;
  }

  .info-row {
    display: flex;
    margin: 5px 0;
    font-size: 9pt;
  }

  .info-label {
    font-weight: bold;
    min-width: 150px;
  }

  .info-value {
    flex: 1;
  }

  .section-header {
    font-weight: bold;
    margin-top: 15px;
    margin-bottom: 8px;
    font-size: 9pt;
    text-decoration: underline;
  }

  .tug-section {
    border: 1px solid #000;
    padding: 10px;
    margin: 10px 0;
  }

  .tug-header {
    font-weight: bold;
    margin-bottom: 8px;
    font-size: 9pt;
  }

  .footer-section {
    display: flex;
    justify-content: space-between;
    margin-top: 30px;
    border-top: 2px solid #000;
    padding-top: 10px;
  }

  .qr-box {
    text-align: center;
    flex: 1;
  }

  .qr-placeholder {
    width: 80px;
    height: 80px;
    border: 1px solid #000;
    margin: 10px auto;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 8pt;
  }

  .qr-label {
    font-size: 8pt;
    font-weight: bold;
  }

  .note-section {
    margin-top: 20px;
    font-size: 8pt;
    border-top: 1px solid #000;
    padding-top: 10px;
  }

  .note-section strong {
    display: block;
    margin-bottom: 5px;
  }

  .two-column {
    display: flex;
    gap: 20px;
  }

  .column {
    flex: 1;
  }

  @media print {
    body {
      background: white;
    }
    .page {
      box-shadow: none;
      margin: 0;
      padding: 10mm;
    }
  }
</style>

<div class="page">
  <!-- Header -->
  <div class="header">
    <div class="logo">
      <svg width="60" height="60" viewBox="0 0 60 60">
        <rect width="60" height="60" fill="#fff" stroke="#000" stroke-width="2"/>
        <text x="30" y="35" text-anchor="middle" font-size="10" font-weight="bold">LOGO</text>
      </svg>
    </div>
    <div class="company-info">
      <strong>PT.Haswarpin Group</strong><br>
      No.surat _____________<br>
      _____________
    </div>
  </div>

  <!-- Title -->
  <h1>BUKTI PEMAKAIAN JASA PANDU</h1>
  <h2>PILOT CERTIFICATE</h2>

  <!-- Declaration -->
  <div class="declaration">
    <strong>Untuk melaksanakan Pemanduan/Penanduan terhadap kapal tersebut di bawah ini :</strong><br>
    <em>To perform Pilotage / Towage for the ship below :</em>
  </div>

  <!-- Main Content Box -->
  <div class="content-box">
    <!-- Two Column Layout -->
    <div class="two-column">
      <div class="column">
        <div class="info-row">
          <span class="info-label">Nama Kapal :</span>
          <span class="info-value"><%= service.shipDetails[0]?.shipName || '-' %></span>
        </div>
        <div class="info-row" style="margin-left: 0px;">
          <em style="font-size: 8pt;">Vessel</em>
        </div>
        
        <div class="info-row">
          <span class="info-label">Nama Nahkoda :</span>
          <span class="info-value"><%= service.shipDetails[0]?.master || '-' %></span>
        </div>
        <div class="info-row" style="margin-left: 0px;">
          <em style="font-size: 8pt;">Master Name</em>
        </div>
        
        <div class="info-row">
          <span class="info-label">Bendera :</span>
          <span class="info-value"><%= service.shipDetails[0]?.flag || 'INDONESIA' %></span>
        </div>
        <div class="info-row" style="margin-left: 0px;">
          <em style="font-size: 8pt;">Flag</em>
        </div>
        
        <div class="info-row">
          <span class="info-label" ">Datang Dari :</span>
          <span class="info-value" "></span>
        </div>
        <div class="info-row" style="margin-left: 0px;">
          <em style="font-size: 8pt;">Last Port of Call</em>
        </div>
        
        <div class="info-row">
          <span class="info-label">Isi Kotor :</span>
          <span class="info-value"><%= service.shipDetails[0]?.grt || '1553' %></span>
        </div>
        <div class="info-row" style="margin-left: 0px;">
          <em style="font-size: 8pt;">GRT</em>
        </div>
      </div>

      <div class="column">
        <div class="info-row">
          <span class="info-label">Nama Penggilan :</span>
          <span class="info-value">-</span>
        </div>
        <div class="info-row" style="margin-left: 0px;">
          <em style="font-size: 8pt;">Call Sign</em>
        </div>
        
        <div class="info-row">
          <span class="info-label">Keagenan Kapal :</span>
          <span class="info-value"> </span>
        </div>
        <div class="info-row" style="margin-left: 0px;">
          <em style="font-size: 8pt;">Agent</em>
        </div>
        
        <div class="info-row">
          <span class="info-label" >Tujuan Ke :</span>
          <span class="info-value" ></span>
        </div>
        <div class="info-row" style="margin-left: 0px;">
          <em style="font-size: 8pt;">Next Port of Call</em>
        </div>
        
        <div class="info-row">
          <span class="info-label">Panjang :</span>
          <span class="info-value"><%= service.shipDetails[0]?.loa || '70.10' %> m</span>
        </div>
        <div class="info-row" style="margin-left: 0px;">
          <em style="font-size: 8pt;">LOA</em>
        </div>
      </div>
    </div>

    <!-- Pilot Declaration -->
    <div class="section-header" style="margin-top: 20px;">
      Menerangkan Bahwa<br>
      <em style="font-size: 8pt; font-weight: normal;">DECLARES THAT</em>
    </div>
    
    <div style="font-size: 9pt; margin: 10px 0;">
      KAPAL TELAH DIPANDU OLEH <strong>NAMA PANDU : <%= service.pilot?.name || 'Heri Supriyono' %></strong><br>
      <em style="font-size: 8pt;"> SHIP HAS ALREADY PILOTED BY THE HARBOUR PILOT : <strong><%= service.pilot?.name || 'Heri Supriyono' %></strong></em>
    </div>

    <div class="two-column" style="margin-top: 15px;">
      <div class="column">
        <div class="info-row">
          <span class="info-label">Dari :</span>
          <span class="info-value"></span>
        </div>
        <div class="info-row" style="margin-left: 0px;">
          <em style="font-size: 8pt;">From</em>
        </div>
        
        <div class="info-row">
          <span class="info-label">Pandu Naik Ke Kapal :</span>
          <span class="info-value"><%= service.startTimeFormatted || '00:00:00' %></span>
        </div>
        <div class="info-row" style="margin-left: 0px;">
          <em style="font-size: 8pt;">Pilot On Board</em>
        </div>
        
        <div class="info-row">
          <span class="info-label">Kapal Berhenti :</span>
          <span class="info-value"><%= service.endTimeFormatted || '01:00:00' %></span>
        </div>
        <div class="info-row" style="margin-left: 0px;">
          <em style="font-size: 8pt;">Pilot Finished</em>
        </div>
      </div>

      <div class="column">
        <div class="info-row">
          <span class="info-label">Ke :</span>
          <span class="info-value"></span>
        </div>
        <div class="info-row" style="margin-left: 0px;">
          <em style="font-size: 8pt;">To</em>
        </div>
        
        <div class="info-row">
          <span class="info-label">Kapal Bergerak :</span>
          <span class="info-value"><%= service.startTimeFormatted || '00:00:00' %></span>
        </div>
        <div class="info-row" style="margin-left: 0px;">
          <em style="font-size: 8pt;">Ship Start</em>
        </div>
        
        <div class="info-row">
          <span class="info-label">Pandu Turun Dari Kapal :</span>
          <span class="info-value"><%= service.endTimeFormatted || '01:00:00' %></span>
        </div>
        <div class="info-row" style="margin-left: 0px;">
          <em style="font-size: 8pt;">Pilot Get Off</em>
        </div>
        
        <div class="info-row">
          <span class="info-label">Pada Tanggal :</span>
          <span class="info-value"><%= service.startDateFormatted || '01-11-2025' %></span>
        </div>
        <div class="info-row" style="margin-left: 0px;">
          <em style="font-size: 8pt;">On Date</em>
        </div>
      </div>
    </div>

    <!-- Tug Service Section -->
    <% if (service.tugServices && service.tugServices.length > 0) { %>
      <div class="section-header" style="margin-top: 20px;">
        IA TELAH MENGGUNAKAN KAPAL TUNDA<br>
        <em style="font-size: 8pt; font-weight: normal;">SHE DULY USED THE TUG BOAT</em>
      </div>
      
      <% service.tugServices.forEach(t => { %>
        <% t.tugDetails.forEach(tug => { %>
          <div class="tug-section">
            <div class="info-row">
              <span class="info-label">Nama :</span>
              <span class="info-value"><%= tug.assistTug?.shipName || 'ASL CALYPSO, TB' %></span>
            </div>
            <div class="info-row" style="margin-left: 0px;">
              <em style="font-size: 8pt;">Name</em>
            </div>
            
            <div class="two-column" style="margin-top: 10px;">
              <div style="flex: 1;">
                <div class="info-row">
                  <span class="info-label" style="min-width: 120px;">Berkekuatan Tenaga :</span>
                  <span class="info-value">3000</span>
                </div>
                <div style="margin-left: 120px;">
                  <em style="font-size: 8pt;">Engine Power</em>
                </div>
              </div>
              
              <div style="flex: 1;">
                <div class="info-row">
                  <span class="info-label" style="min-width: 100px;">TK Daya Tarik :</span>
                  <span class="info-value">MT Pukul : <%= tug.connectTime || '00:15:00' %></span>
                </div>
                <div style="margin-left: 100px;">
                  <em style="font-size: 8pt;">HP Bollard Pull &nbsp;&nbsp;&nbsp; Mt Time</em>
                </div>
              </div>
              
              <div style="flex: 1;">
                <div class="info-row">
                  <span class="info-label" style="min-width: 80px;">Sampai :</span>
                  <span class="info-value"><%= tug.disconnectTime || '00:45:00' %></span>
                </div>
                <div style="margin-left: 80px;">
                  <em style="font-size: 8pt;">Up To</em>
                </div>
              </div>
              
              <div style="flex: 1;">
                <div class="info-row">
                  <span class="info-label" style="min-width: 80px;">Total Jam :</span>
                  <span class="info-value">00:30:00</span>
                </div>
                <div style="margin-left: 80px;">
                  <em style="font-size: 8pt;">Total Hour</em>
                </div>
              </div>
            </div>
          </div>
        <% }) %>
      <% }) %>
    <% } %>
  </div>

  <!-- QR Code Footer -->
  <div class="footer-section">
    <div class="qr-box">
      <div class="qr-label">MENGETAHUI<br>ASISTEN MANAJER BISNIS</div>
      <div class="qr-placeholder">[QR CODE]</div>
    </div>
    
    <div class="qr-box">
      <div class="qr-label">NAHKODA KAPAL PANDU</div>
      <div class="qr-placeholder">[QR CODE]</div>
    </div>
    
    <div class="qr-box">
      <div class="qr-label">PADA TANGGAL<br>ON DATE</div>
      <div class="qr-placeholder">[QR CODE]</div>
      <div class="qr-label" style="margin-top: 5px;">NAHKODA / AGEN<br>MASTER</div>
    </div>
  </div>

  <!-- Notes -->
  <div class="note-section">
    <strong>CATATAN / NOTE:</strong>
    <p style="margin: 5px 0; line-height: 1.4;">
      Jasa kapal Tug Boat dihitung secara perubahan adanya standar-standar waktu pembulat dan atau dalam untuk dikembalikan (....menit).<br>
      <em>Services charges of Tug Boat will be calculated based on this time for moving and the used again. System is awaiting the next order to return, it addition to be reported.</em><br>
      <em>Please note: overhaul any important news / incident to be reported.</em>
    </p>
  </div>
</div>